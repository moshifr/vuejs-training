(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{997:function(t,e,s){"use strict";s.r(e);var n=s(25),a=Object(n.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"unit-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#unit-tests"}},[t._v("#")]),t._v(" Unit tests")]),t._v(" "),s("h2",{attrs:{id:"why-should-i-write-automated-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#why-should-i-write-automated-tests"}},[t._v("#")]),t._v(" Why should I write automated tests ?")]),t._v(" "),s("p",[t._v("Automated testing is an essential step in software development, and bring many benefits:")]),t._v(" "),s("ul",[s("li",[t._v("document how a component should behave")]),t._v(" "),s("li",[t._v("detect and fix bugs sooner and more effectively")]),t._v(" "),s("li",[t._v("save time spent manually testing")]),t._v(" "),s("li",[t._v("encourage refactoring with complete peace of mind")])]),t._v(" "),s("h2",{attrs:{id:"different-types-of-automated-tests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#different-types-of-automated-tests"}},[t._v("#")]),t._v(" Different types of automated tests")]),t._v(" "),s("ul",[s("li",[s("strong",[t._v("Unit")]),t._v(": Checks that inputs to a given function, class, or composable are producing the expected output or side effects.")]),t._v(" "),s("li",[s("strong",[t._v("Component")]),t._v(": Checks that your component mounts, renders, can be interacted with, and behaves as expected. These tests import more code than unit tests, are more complex, and require more time to execute.")]),t._v(" "),s("li",[s("strong",[t._v("End-to-end")]),t._v(": Checks features that span multiple pages and make real network requests against your production-built Vue application. These tests often involve standing up a database or other backend.")])]),t._v(" "),s("h2",{attrs:{id:"choose-your-test-runner"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#choose-your-test-runner"}},[t._v("#")]),t._v(" Choose your test runner")]),t._v(" "),s("p",[t._v("In order to test your application, you will need a test runner which will launch your test and collect the results. Vue team recommends "),s("a",{attrs:{href:"https://vitest.dev/",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Vitest")]),s("OutboundLink")],1),t._v(" for unit tests and simple components (no interaction), and "),s("a",{attrs:{href:"https://on.cypress.io/component",target:"_blank",rel:"noopener noreferrer"}},[s("code",[t._v("Cypress")]),s("OutboundLink")],1),t._v("  for more complex components and end-to-end testing.")]),t._v(" "),s("p",[t._v("The main difference between these two is execution context and execution time. Cypress runs tests in a real browser, which let you find some issues that Vitest can't spot: CSS issues, DOM events, failed network requests...")]),t._v(" "),s("p",[t._v("Vitest and Cypress should be already installed on your project if you followed the project init instructions correctly.")]),t._v(" "),s("p",[t._v("For more information and alternative tooling, please check "),s("a",{attrs:{href:"https://vuejs.org/guide/scaling-up/testing.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("official documentation"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"vue-test-utils"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#vue-test-utils"}},[t._v("#")]),t._v(" Vue Test Utils")]),t._v(" "),s("p",[t._v("To make it easier to write tests for Vue components, the team also provides "),s("a",{attrs:{href:"https://vue-test-utils.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue Test Utils"),s("OutboundLink")],1),t._v(", the official library of unit test utilities for Vue.js. It comes with a "),s("a",{attrs:{href:"https://vue-test-utils.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("detailed guide"),s("OutboundLink")],1),t._v(" to help you set up your tests with custom configurations.")]),t._v(" "),s("p",[t._v("This library offers an API to test the Vue components, here are some of the most used methods:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("mount")]),t._v(": creates a "),s("code",[t._v("Wrapper")]),t._v(" that contains the mounted and rendered Vue component;")]),t._v(" "),s("li",[s("code",[t._v("shallowMount")]),t._v(": like "),s("code",[t._v("mount")]),t._v(", it creates a "),s("code",[t._v("Wrapper")]),t._v(" that contains the mounted and rendered Vue component, but with stubbed child components;")]),t._v(" "),s("li",[s("code",[t._v("createLocalVue")]),t._v(": "),s("em",[t._v("(only for Vue 2)")]),t._v(" returns a Vue class for you to add components, mixins and install plugins without polluting the global Vue class.")])]),t._v(" "),s("p",[t._v("The class "),s("code",[t._v("Wrapper")]),t._v(" representing your mounted component offers method such as:")]),t._v(" "),s("ul",[s("li",[s("code",[t._v(".html()")]),t._v(", "),s("code",[t._v(".text()")]),t._v(": get the HTML or text content")]),t._v(" "),s("li",[s("code",[t._v(".find()")]),t._v(", "),s("code",[t._v(".findAll()")]),t._v(": search for HTML in the component")]),t._v(" "),s("li",[s("code",[t._v(".setData()")]),t._v(", "),s("code",[t._v(".setMethods()")]),t._v(", "),s("code",[t._v(".setProps()")]),t._v(": override options in your component")]),t._v(" "),s("li",[s("code",[t._v(".trigger()")]),t._v(": trigger events")])]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),s("p",[t._v("The methods described above make it possible to test most simple cases. For more information refer to the "),s("a",{attrs:{href:"https://vue-test-utils.vuejs.org/",target:"_blank",rel:"noopener noreferrer"}},[t._v("official documentation"),s("OutboundLink")],1),t._v(".")])]),t._v(" "),s("h2",{attrs:{id:"write-your-first-test-with-vitest-and-vue-test-utils"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#write-your-first-test-with-vitest-and-vue-test-utils"}},[t._v("#")]),t._v(" Write your first test with Vitest and Vue Test Utils")]),t._v(" "),s("p",[t._v("By default, Vitest will run all tests in a "),s("code",[t._v("tests / unit")]),t._v(" or"),s("code",[t._v("__tests__")]),t._v(" folder. For example, the tests in "),s("code",[t._v("Film.spec.js")]),t._v(" and"),s("code",[t._v("LoginForm.spec.js")]),t._v(" will be spotted and run by Vitest here:")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("-- components\n  |-- Film.vue\n  |-- LoginForm.vue\n  |-- __tests__\n    |-- Film.spec.js\n    |-- LoginForm.spec.js\n")])])]),s("p",[t._v("Here is a basic example of what the tests of "),s("code",[t._v("LoginForm")]),t._v(" could look like:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" mount "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@vue/test-utils'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" LoginForm "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../LoginForm.vue'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'render the form and check the title'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrapper "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("LoginForm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" title "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" wrapper"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h1'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authentication'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h2",{attrs:{id:"mocking"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mocking"}},[t._v("#")]),t._v(" Mocking")]),t._v(" "),s("p",[t._v("The "),s("strong",[t._v("mocking")]),t._v(" consists of isolating the test subject by replacing it with a mockup that simulate all the external bricks it interacts with. Thus, in case of failure of the test, it is ensured that the problem comes from the tested function and not from an external component (network, databases, third party, etc.).")]),t._v(" "),s("p",[t._v("Below are some examples to illustrate Vitest's mocking ability:")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" vi "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vitest'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Mocking a local function")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" ApiService "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/services/api.js'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" FilmService "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/services/film.js'")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Film search returns no results'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("done")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mock the API to return a empty list")]),t._v("\n    ApiService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("api "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" vi"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("fn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" Promise"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("resolve")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\n    FilmService"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("search")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"something"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("then")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("results")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("results"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBe")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("done")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("h2",{attrs:{id:"practical-work-test-the-film-component"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#practical-work-test-the-film-component"}},[t._v("#")]),t._v(" Practical work: Test the Film component")]),t._v(" "),s("ol",[s("li",[t._v("Create a unit test spec file for your "),s("code",[t._v("Film.vue")]),t._v(" component.")]),t._v(" "),s("li",[t._v("In your test, mount the component, add a basic assertion, and run the tests.")]),t._v(" "),s("li",[t._v("Simulate the values ​​of a film and check the HTML rendering.")]),t._v(" "),s("li",[t._v("Add the calculation of the code coverage. What do you notice?")]),t._v(" "),s("li",[s("strong",[t._v("Bonus")]),t._v(": Test the "),s("code",[t._v("LoginForm.vue")]),t._v(" component, simulating HTTPS external calls as well as calls to the store and the router. Test the nominal and login error case.")])])])}),[],!1,null,null,null);e.default=a.exports}}]);